#  为什么要用缓存

![](https://gitee.com/lidaming/assets/raw/master/earth.jpg)

> 百度百科解释：缓存（cache），原始意义是指访问速度比一般[随机存取存储器](https://baike.baidu.com/item/随机存取存储器)（RAM）快的一种高速存储器，通常它不像系统主存那样使用[DRAM](https://baike.baidu.com/item/DRAM)技术，而使用昂贵但较快速的[SRAM](https://baike.baidu.com/item/SRAM)技术。缓存的设置是所有现代计算机系统发挥高性能的重要因素之一。



可以看到解释的重点是**更快的高速存储器**，**系统发挥高性能的重要因素**。表达出来的意思就是可以让系统短时间内做更多的操作，系统的性能达到更高。

显而易见，如果你使用缓存，不是为了提供系统的速度，不是为了提升系统的性能，就就是为了用而用，就是看啥都是钉子~~

## 速度 VS 性能

在聊缓存的时候，聊到了速度和性能！速度和性能可以划等号吗？

当我们在聊一个web服务的时候，会说`RT< 200ms` ，这是对某个请求的完整处理过程的时长要求，时间越短，速度越快。当我在数据序列化的时候，这次访问数据库耗时 `20ms`,这是对数据库操作的一个时长描述。当我们说这个Job 处理了30分钟，描述了这个任务需要的时长，等等。相关例子数不胜数。

在开发和系统运行的过程中，系统提升速度，提升性能的本质是什么呢？想要发现本质，就需要拨开云雾见月明的能力和洞察力。计算机运行体系如下图：

![](https://gitee.com/lidaming/assets/raw/master/computor_struct.jfif)

可以看到计算机在运行中涉及到的组件，以及它们之间的交互，接下来看下整个体系中的涉及到的缓存。

![](https://gitee.com/lidaming/assets/raw/master/computor_cache.jpg)

缓存已经到了每个组件的方方面面。接下来对比下不同存储设备速度差异。

![](https://gitee.com/lidaming/assets/raw/master/cache_time.png)



计算机中CPU的速度很快，但是其他的外部存储相对的读写就慢了很多，有了这些缓存的加成，带来的计算机的性能变化，简单对比下CPU和缓存的性能（来源网络）如下：

![](https://gitee.com/lidaming/assets/raw/master/cache_preformance.jpg)



当然，计算机在很多细节上也进行了优化，如：缓存行的设计、缓存页的设计、套接字缓存等



## 系统有缓存了，我们再缓存有必要吗？

聊一个事情，有没有做的必要性！是需要加入一些背景进行考虑的。先聊一下相关的背景。

- 秒杀、抢购等场景

  这个场景很成熟了，特点就是：流量高，时间集中，到来时间可预测，峰值可评估。

  核心流程大概：展示 信息 -> 处理锁定 -> 完成动作。操作类型为：读 -> 写 -> 写

- 集中式服务，如：配置中心、注册中心等

- 核心模块，如：登录、验证码等

  